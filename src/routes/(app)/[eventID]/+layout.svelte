<script lang="ts">
	import type { LayoutData } from './$types'

	import Modal from 'svelte-simple-modal';
	import { globalModalState } from '$lib/store';
	import ConnectionMaster from '$lib/components/connectionInfo/connectionMaster.svelte';
	import LayoutHeader from '$lib/components/layouts/LayoutHeader.svelte';

	import { page } from '$app/stores';

	export let data: LayoutData;
</script>

<LayoutHeader>
	<div slot="content" class="breadcrumbs">
		<a href="/checkin/events" title="Home">
			<svg width="27" height="24" viewBox="0 0 27 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path d="M12.6148 0.644531C13.0191 0.330078 13.6031 0.330078 14.0074 0.644531L25.8667 10.707C26.3159 11.1113 26.3609 11.7852 26.0015 12.2344C25.5972 12.6836 24.9234 12.7285 24.4742 12.3691L23.396 11.4258V19.7812C23.396 21.8027 21.7788 23.375 19.8023 23.375H6.86478C4.84329 23.375 3.27103 21.8027 3.27103 19.7812V11.4258L2.14798 12.3691C1.69876 12.7285 1.02493 12.6836 0.620636 12.2344C0.261261 11.7852 0.306183 11.1113 0.755402 10.707L12.6148 0.644531ZM5.42728 9.58398V19.7812C5.42728 20.5898 6.05618 21.2188 6.86478 21.2188H19.8023C20.5659 21.2188 21.2398 20.5898 21.2398 19.7812V9.58398L13.3335 2.89062L5.42728 9.58398Z" fill="white"/>
			</svg>
		</a>
		<span class="header-nav-event">
			{#await data.event}
				Loadingâ€¦
			{:then event}
				{event.name}
			{:catch}
				Load error
			{/await}
		</span>
	</div>
</LayoutHeader>

<Modal
	show={ $globalModalState }
	styleBg={{ "justify-content": "flex-start" }}
	styleWindowWrap={{ margin: "1.5rem 1rem" }}
	styleWindow={{ margin: "auto" }}
	styleContent={{ "padding-top": "3.5rem" }}
	closeOnOuterClick={ false }
	on:closed={() => globalModalState.set(null)}
>
	<ConnectionMaster/>
	{#await data.event}
		<!-- no loading placeholder -->
	{:then event}
		<nav class="navbar">
			<a
				href={`/checkin/events/${event.id}`}
				class="nav-link-button"
				class:isCurrent={$page.url.pathname === `/checkin/events/${event.id}`}
			>
				<svg width="25" height="25" viewBox="0 0 25 25" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path d="M12.4742 0.5C12.9429 0.5 13.3179 0.78125 13.5054 1.15625L16.7398 7.76562L23.9117 8.84375C24.3335 8.89062 24.6617 9.21875 24.8023 9.59375C24.9429 10.0156 24.8492 10.4375 24.521 10.7656L19.3179 15.9219L20.5367 23.1875C20.6304 23.6094 20.4429 24.0781 20.1148 24.3125C19.7398 24.5469 19.271 24.5938 18.896 24.4062L12.4742 20.9375L6.05228 24.4062C5.67728 24.5938 5.2554 24.5469 4.8804 24.3125C4.55228 24.0781 4.36478 23.6094 4.41165 23.1875L5.67728 15.9219L0.474152 10.7656C0.146027 10.4375 0.0522766 10.0156 0.192902 9.59375C0.333527 9.21875 0.661652 8.89062 1.08353 8.84375L8.2554 7.76562L11.4898 1.15625C11.6773 0.78125 12.0523 0.5 12.4742 0.5ZM12.4742 4.20312L10.0367 9.3125C9.84915 9.64062 9.5679 9.875 9.1929 9.92188L3.61478 10.7188L7.64603 14.7031C7.92728 14.9844 8.02103 15.3594 7.97415 15.7344L7.03665 21.3125L11.9585 18.6875C12.2867 18.5 12.7085 18.5 13.0367 18.6875L17.9585 21.3125L17.021 15.7344C16.9273 15.3594 17.0679 14.9844 17.3492 14.7031L21.3335 10.7188L15.8023 9.92188C15.4273 9.875 15.0992 9.64062 14.9585 9.3125L12.4742 4.20312Z" />
				</svg>
				<span>Dashboard</span>
			</a>
			<a
				href={`/checkin/events/${event.id}/edit`}
				class="nav-link-button"
				class:isCurrent={$page.url.pathname === `/checkin/events/${event.id}/edit`}
			>
				<svg width="22" height="21" viewBox="0 0 22 21" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path d="M5.14603 3.375C5.52103 3.375 5.89603 3.75 5.89603 4.125V4.875C5.89603 5.29688 5.52103 5.625 5.14603 5.625H4.39603C3.97415 5.625 3.64603 5.29688 3.64603 4.875V4.125C3.64603 3.75 3.97415 3.375 4.39603 3.375H5.14603ZM0.271027 2.25C0.271027 1.03125 1.2554 0 2.52103 0H7.02103C8.23978 0 9.27103 1.03125 9.27103 2.25V6.75C9.27103 8.01562 8.23978 9 7.02103 9H2.52103C1.2554 9 0.271027 8.01562 0.271027 6.75V2.25ZM2.52103 6.75H7.02103V2.25H2.52103V6.75ZM3.64603 16.125C3.64603 15.75 3.97415 15.375 4.39603 15.375H5.14603C5.52103 15.375 5.89603 15.75 5.89603 16.125V16.875C5.89603 17.2969 5.52103 17.625 5.14603 17.625H4.39603C3.97415 17.625 3.64603 17.2969 3.64603 16.875V16.125ZM0.271027 14.25C0.271027 13.0312 1.2554 12 2.52103 12H7.02103C8.23978 12 9.27103 13.0312 9.27103 14.25V18.75C9.27103 20.0156 8.23978 21 7.02103 21H2.52103C1.2554 21 0.271027 20.0156 0.271027 18.75V14.25ZM2.52103 18.75H7.02103V14.25H2.52103V18.75ZM17.146 3.375C17.521 3.375 17.896 3.75 17.896 4.125V4.875C17.896 5.29688 17.521 5.625 17.146 5.625H16.396C15.9742 5.625 15.646 5.29688 15.646 4.875V4.125C15.646 3.75 15.9742 3.375 16.396 3.375H17.146ZM19.021 0C20.2398 0 21.271 1.03125 21.271 2.25V6.75C21.271 8.01562 20.2398 9 19.021 9H14.521C13.2554 9 12.271 8.01562 12.271 6.75V2.25C12.271 1.03125 13.2554 0 14.521 0H19.021ZM19.021 2.25H14.521V6.75H19.021V2.25ZM18.271 21H16.771V19.5H18.271V21ZM19.771 19.5H21.271V21H19.771V19.5ZM21.271 18H16.771V16.5H15.271V21H12.271V12H16.771V13.5H19.771V12H21.271V18Z"/>
				</svg>
				<span>Scan</span>
			</a>
			<a
				href={`/checkin/events/${event.id}/attendees`}
				class="nav-link-button"
				class:isCurrent={$page.url.pathname === `/checkin/events/${event.id}/attendees`}
			>
				<svg width="31" height="24" viewBox="0 0 31 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path d="M14.9742 15C17.6929 15 19.8492 12.8438 19.8492 10.125C19.8492 7.45312 17.646 5.25 14.9742 5.25C12.3023 5.25 10.146 7.45312 10.146 10.125C10.0992 12.8438 12.3023 15 14.9742 15ZM14.9742 7.5C16.4273 7.5 17.5992 8.71875 17.5992 10.125C17.5992 11.5781 16.4273 12.75 14.9742 12.75C13.5679 12.75 12.3492 11.5781 12.3492 10.125C12.3492 8.71875 13.5679 7.5 14.9742 7.5ZM24.021 7.5C26.0835 7.5 27.771 5.85938 27.771 3.75C27.771 1.6875 26.0835 0 24.021 0C21.9117 0 20.271 1.6875 20.271 3.75C20.271 5.85938 21.9117 7.5 24.021 7.5ZM17.3179 16.5H12.6773C8.97415 16.5 6.02103 19.3125 6.02103 22.7812C6.02103 23.4844 6.58353 24 7.33353 24H22.6617C23.4117 24 24.021 23.4844 24.021 22.7812C24.021 19.3125 21.021 16.5 17.3179 16.5ZM8.36478 21.75C8.83353 20.0625 10.5679 18.75 12.6304 18.75H17.3179C19.3804 18.75 21.1148 20.0625 21.6304 21.75H8.36478ZM25.8492 9H22.9898C22.3804 9 21.8179 9.1875 21.3023 9.42188C21.3023 9.65625 21.3492 9.89062 21.3492 10.125C21.3492 11.7188 20.7867 13.1719 19.8023 14.25H29.1773C29.646 14.25 30.021 13.875 30.021 13.4062C30.021 10.9688 28.146 9 25.8492 9ZM8.59915 10.125C8.59915 9.89062 8.64603 9.65625 8.6929 9.42188C8.17728 9.14062 7.61478 9 7.0054 9H4.14603C1.84915 9 0.0210266 10.9688 0.0210266 13.4062C0.0210266 13.875 0.349152 14.25 0.817902 14.25H10.1929C9.20853 13.1719 8.59915 11.7188 8.59915 10.125ZM6.02103 7.5C8.08353 7.5 9.77103 5.85938 9.77103 3.75C9.77103 1.6875 8.08353 0 6.02103 0C3.91165 0 2.27103 1.6875 2.27103 3.75C2.27103 5.85938 3.91165 7.5 6.02103 7.5Z"/>
				</svg>
				<span>Attendees</span>
			</a>
			<a
				href={`/checkin/events/${event.id}/settings`}
				class="nav-link-button"
				class:isCurrent={$page.url.pathname === `/checkin/events/${event.id}/settings`}
			>
				<svg width="25" height="24" viewBox="0 0 25 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path d="M7.77103 12C7.77103 9.51562 9.73978 7.5 12.271 7.5C14.7554 7.5 16.771 9.51562 16.771 12C16.771 14.4844 14.7554 16.5 12.271 16.5C9.73978 16.5 7.77103 14.4844 7.77103 12ZM12.271 9.75C11.0054 9.75 10.021 10.7812 10.021 12C10.021 13.2656 11.0054 14.25 12.271 14.25C13.4898 14.25 14.521 13.2656 14.521 12C14.521 10.7812 13.4898 9.75 12.271 9.75ZM14.0054 0C15.0367 0 15.9273 0.75 16.1617 1.73438L16.5367 3.28125C16.9585 3.46875 17.3335 3.70312 17.6617 3.9375L19.2085 3.46875C20.1929 3.1875 21.271 3.60938 21.7867 4.5L23.521 7.54688C24.0367 8.4375 23.8492 9.5625 23.0992 10.2656L21.9742 11.3438C21.9742 11.5781 22.021 11.8125 22.021 12C22.021 12.2344 21.9742 12.4688 21.9742 12.6562L23.0992 13.7812C23.8492 14.4844 24.0367 15.6094 23.521 16.5L21.7867 19.5469C21.271 20.4375 20.1929 20.8594 19.2085 20.5781L17.6617 20.1094C17.3335 20.3438 16.9585 20.5781 16.5367 20.7656L16.1617 22.3125C15.9273 23.2969 15.0367 24 14.0054 24H10.4898C9.45853 24 8.5679 23.2969 8.33353 22.3125L7.95853 20.7656C7.53665 20.5781 7.16165 20.3438 6.83353 20.1094L5.28665 20.5781C4.30228 20.8594 3.22415 20.4375 2.70853 19.5469L0.974152 16.5C0.458527 15.6094 0.646027 14.4844 1.39603 13.7812L2.52103 12.6562C2.52103 12.4688 2.52103 12.2344 2.52103 12C2.52103 11.8125 2.52103 11.5781 2.52103 11.3438L1.39603 10.2656C0.646027 9.5625 0.458527 8.4375 0.974152 7.54688L2.70853 4.5C3.22415 3.60938 4.30228 3.1875 5.28665 3.46875L6.83353 3.9375C7.16165 3.70312 7.53665 3.46875 7.95853 3.28125L8.33353 1.73438C8.5679 0.75 9.45853 0 10.4898 0H14.0054ZM9.8804 4.875L9.36478 5.10938C8.7554 5.34375 8.1929 5.67188 7.72415 6.04688L7.2554 6.42188L4.67728 5.625L2.9429 8.67188L4.86478 10.5L4.8179 11.0625C4.77103 11.3906 4.77103 11.7188 4.77103 12C4.77103 12.3281 4.77103 12.6562 4.8179 12.9844L4.86478 13.5469L2.9429 15.375L4.67728 18.4219L7.2554 17.625L7.72415 18C8.1929 18.375 8.7554 18.7031 9.36478 18.9375L9.8804 19.1719L10.4898 21.75H14.0054L14.6148 19.1719L15.1304 18.9375C15.7398 18.7031 16.3023 18.375 16.771 18L17.2398 17.625L19.8179 18.4219L21.5523 15.375L19.6304 13.5469L19.6773 12.9844C19.7242 12.6562 19.771 12.3281 19.771 12C19.771 11.7188 19.7242 11.3906 19.6773 11.0625L19.6304 10.5L21.5523 8.67188L19.8179 5.625L17.2398 6.42188L16.771 6.04688C16.3023 5.67188 15.7398 5.34375 15.1304 5.10938L14.6148 4.875L14.0054 2.25H10.4898L9.8804 4.875Z" />
				</svg>
				<span>Settings</span>
			</a>
		</nav>
	{/await}
	<main class="container m-auto">
		<slot />
	</main>
</Modal>

<style lang="scss">
	.breadcrumbs {
		color: #FFFFFF;
		display: flex;
		align-items: center;
		gap: 1em;
		font: {
			weight: bold;
		}
	}

	.header-nav-event {
		overflow: hidden;
		display: -webkit-box;
		-webkit-box-orient: vertical;
		-webkit-line-clamp: 2;
	}

	.navbar {
		background-color: #FFFFFF;
		display: flex;
		justify-content: space-between;
	}

	.nav-link-button {
		border-bottom: 0.25em solid transparent;
		color: #000000;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 0.4em;
		padding: 1rem 1rem calc(0.8rem - 0.25em) 1rem;
		text-decoration: none;

		&:hover,
		&.isCurrent {
			color: #D02366;
			border-bottom-color: currentColor;
		}
	}
</style>
